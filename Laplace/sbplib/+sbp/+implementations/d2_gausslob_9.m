% Central SBP on 10 gridpoints Gauss-Labotto
function [D1,H,x,e_l,e_r] = d2_gausslob_9(lim)
% Create operators for [-1,1] 
m=10;
x=[-1; -0.919533908166458813828932660822e0; -0.738773865105505075003106174860e0; -0.477924949810444495661175092731e0; -0.165278957666387024626219765958e0; 0.165278957666387024626219765958e0; 0.477924949810444495661175092731e0; 0.738773865105505075003106174860e0; 0.919533908166458813828932660822e0; 1;];

H=[0.222222222222222222222222222222e-1 0 0 0 0 0 0 0 0 0; 0 0.133305990851070111126227170423e0 0 0 0 0 0 0 0 0; 0 0 0.224889342063126452119457821756e0 0 0 0 0 0 0 0; 0 0 0 0.292042683679683757875582257406e0 0 0 0 0 0 0; 0 0 0 0 0.327539761183897456656510527916e0 0 0 0 0 0; 0 0 0 0 0 0.327539761183897456656510527916e0 0 0 0 0; 0 0 0 0 0 0 0.292042683679683757875582257406e0 0 0 0; 0 0 0 0 0 0 0 0.224889342063126452119457821756e0 0 0; 0 0 0 0 0 0 0 0 0.133305990851070111126227170423e0 0; 0 0 0 0 0 0 0 0 0 0.222222222222222222222222222222e-1;];

HI=inv(H);
Q=[0 0.676403222872931524810253423765e0 -0.270621037942884879431377146761e0 0.154306410780754534725579378337e0 -0.102207883580069618893001083028e0 0.732142896388707616365830401533e-1 -0.545085372320597129894931976603e-1 0.406569762645165840097252512753e-1 -0.283545519131703061331458425351e-1 0.111111111111111122648761764350e-1; -0.676403222872931524810253423765e0 0 0.957870579809342797968048453212e0 -0.446796872223183676453575781849e0 0.277037575839639363458488493812e0 -0.192620284689529445557174850008e0 0.141191635240589272225061548141e0 -0.104410490045240630275126494027e0 0.724856308544841495739769722347e-1 -0.283545519131703061294449177614e-1; 0.270621037942884879431377146761e0 -0.957870579809342797968048453212e0 0 0.982468346813941014146176425505e0 -0.473245927318646818085935423070e0 0.300208264879260076103709012205e0 -0.210632080377140522521681124298e0 0.152204451649768215151009175159e0 -0.104410490045240630252126250844e0 0.406569762645165839955194917784e-1; -0.154306410780754534725579378337e0 0.446796872223183676453575781849e0 -0.982468346813941014146176425505e0 0 0.989241468751932595802545357692e0 -0.480846550950303545704300874124e0 0.305531949938493785596296896499e0 -0.210632080377140522485311459974e0 0.141191635240589272170750079984e0 -0.545085372320597129617999780886e-1; 0.102207883580069618893001083028e0 -0.277037575839639363458488493812e0 0.473245927318646818085935423070e0 -0.989241468751932595802545357692e0 0 0.990869514814557675799004318067e0 -0.480846550950303545676278903493e0 0.300208264879260076040400441604e0 -0.192620284689529445480334581816e0 0.732142896388707615993060710477e-1; -0.732142896388707616365830401533e-1 0.192620284689529445557174850008e0 -0.300208264879260076103709012205e0 0.480846550950303545704300874124e0 -0.990869514814557675799004318067e0 0 0.989241468751932595774409453906e0 -0.473245927318646818022228653056e0 0.277037575839639363381046388762e0 -0.102207883580069618855406543337e0; 0.545085372320597129894931976603e-1 -0.141191635240589272225061548141e0 0.210632080377140522521681124298e0 -0.305531949938493785596296896499e0 0.480846550950303545676278903493e0 -0.989241468751932595774409453906e0 0 0.982468346813941014109141453302e0 -0.446796872223183676398025324200e0 0.154306410780754534697198544005e0; -0.406569762645165840097252512753e-1 0.104410490045240630275126494027e0 -0.152204451649768215151009175159e0 0.210632080377140522485311459974e0 -0.300208264879260076040400441604e0 0.473245927318646818022228653056e0 -0.982468346813941014109141453302e0 0 0.957870579809342797944232309074e0 -0.270621037942884879416622594769e0; 0.283545519131703061331458425351e-1 -0.724856308544841495739769722347e-1 0.104410490045240630252126250844e0 -0.141191635240589272170750079984e0 0.192620284689529445480334581816e0 -0.277037575839639363381046388762e0 0.446796872223183676398025324200e0 -0.957870579809342797944232309074e0 0 0.676403222872931524806373750670e0; -0.111111111111111122648761764350e-1 0.283545519131703061294449177614e-1 -0.406569762645165839955194917784e-1 0.545085372320597129617999780886e-1 -0.732142896388707615993060710477e-1 0.102207883580069618855406543337e0 -0.154306410780754534697198544005e0 0.270621037942884879416622594769e0 -0.676403222872931524806373750670e0 0;];

e_l=zeros(m,1);e_l(1)=1;
e_r=zeros(m,1);e_r(m)=1;

D1=HI*(Q-1/2*e_l*e_l'+1/2*e_r*e_r') ;

% Rescale to lim 
L = lim{2} - lim{1};

x = 0.5*x + 0.5; % now between 0 and 1
x = lim{1} + L*x; % now between lim(1) and lim(2)

H = H*L/2;
D1 = D1*2/L;

