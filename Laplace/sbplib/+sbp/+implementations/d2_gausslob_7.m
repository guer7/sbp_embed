% Central SBP on 8 gridpoints Gauss-Labotto
function [D1,H,x,e_l,e_r] = d2_gausslob_7(lim)
% Create operators for [-1,1] 
m=8;
x=[-0.10e1; -0.87174014850960661533e0; -0.59170018143314230214e0; -0.20929921790247886873e0; 0.20929921790247886873e0; 0.59170018143314230214e0; 0.87174014850960661533e0; 0.10e1;];

H=[0.35714285714285714286e-1 0 0 0 0 0 0 0; 0 0.21070422714350605181e0 0 0 0 0 0 0; 0 0 0.34112269248350436209e0 0 0 0 0 0; 0 0 0 0.41245879465870388154e0 0 0 0 0; 0 0 0 0 0.41245879465870388154e0 0 0 0; 0 0 0 0 0 0.34112269248350436209e0 0 0; 0 0 0 0 0 0 0.21070422714350605181e0 0; 0 0 0 0 0 0 0 0.35714285714285714286e-1;];

HI=inv(H);
Q=[0 0.67634280739696956733e0 -0.27033177926212465223e0 0.15349672015164447023e0 -0.10036389247245554947e0 0.69344979482473710423e-1 -0.46345978153145839705e-1 0.17857142856638294275e-1; -0.67634280739696956733e0 0 0.95735257948973970054e0 -0.44502022584053020828e0 0.27270016402981961393e0 -0.18319638959754637623e0 0.12085265746863267783e0 -0.46345978153145839705e-1; 0.27033177926212465223e0 -0.95735257948973970054e0 0 0.98090423980750199834e0 -0.46828839914674358335e0 0.28825636968192929952e0 -0.18319638959754637623e0 0.69344979482473710423e-1; -0.15349672015164447023e0 0.44502022584053020828e0 -0.98090423980750199834e0 0 0.98533286170799577946e0 -0.46828839914674358335e0 0.27270016402981961393e0 -0.10036389247245554947e0; 0.10036389247245554947e0 -0.27270016402981961393e0 0.46828839914674358335e0 -0.98533286170799577946e0 0 0.98090423980750199834e0 -0.44502022584053020828e0 0.15349672015164447023e0; -0.69344979482473710423e-1 0.18319638959754637623e0 -0.28825636968192929952e0 0.46828839914674358335e0 -0.98090423980750199834e0 0 0.95735257948973970054e0 -0.27033177926212465223e0; 0.46345978153145839705e-1 -0.12085265746863267783e0 0.18319638959754637623e0 -0.27270016402981961393e0 0.44502022584053020828e0 -0.95735257948973970054e0 0 0.67634280739696956733e0; -0.17857142856638294275e-1 0.46345978153145839705e-1 -0.69344979482473710423e-1 0.10036389247245554947e0 -0.15349672015164447023e0 0.27033177926212465223e0 -0.67634280739696956733e0 0;];

e_l=zeros(m,1);e_l(1)=1;
e_r=zeros(m,1);e_r(m)=1;

D1=HI*(Q-1/2*e_l*e_l'+1/2*e_r*e_r') ;

% Rescale to lim 
L = lim{2} - lim{1};

x = 0.5*x + 0.5; % now between 0 and 1
x = lim{1} + L*x; % now between lim(1) and lim(2)

H = H*L/2;
D1 = D1*2/L;
