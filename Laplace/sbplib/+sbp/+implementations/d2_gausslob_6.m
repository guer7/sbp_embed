% Central SBP on 7 gridpoints Gauss-Labotto
function [D1,H,x,e_l,e_r] = d2_gausslob_6(lim)
% Create operators for [-1,1] 
m=7;
d1 = -sqrt(990 - 66*sqrt(165))/66 + 1 - sqrt(990 + 66*sqrt(165))/66;
d2=sqrt(990 - 66*sqrt(165))/33;
x=[-1 (d1-1) (d1+d2-1) 0 1-(d1+d2) 1-d1 1]';

H=[0.1e1 / 0.21e2 0 0 0 0 0 0; 0 0.62e2 / 0.175e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.6600e4 0 0 0 0 0; 0 0 0.62e2 / 0.175e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.6600e4 0 0 0 0; 0 0 0 0.256e3 / 0.525e3 0 0 0; 0 0 0 0 0.62e2 / 0.175e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.6600e4 0 0; 0 0 0 0 0 0.62e2 / 0.175e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.6600e4 0; 0 0 0 0 0 0 0.1e1 / 0.21e2;];

HI=inv(H);
Q=[0 0.13e2 / 0.140e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 0.13e2 / 0.140e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 0.16e2 / 0.105e3 0.13e2 / 0.140e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 0.13e2 / 0.140e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 -0.1e1 / 0.42e2; -0.13e2 / 0.140e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 0 0.121e3 / 0.2800e4 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) + 0.121e3 / 0.42000e5 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) -0.2e1 / 0.75e2 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) - 0.74e2 / 0.28875e5 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) - 0.2e1 / 0.75e2 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) + 0.74e2 / 0.28875e5 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) -0.121e3 / 0.42000e5 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) + 0.121e3 / 0.2800e4 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) 0.353e3 / 0.462000e6 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.400e3 - 0.353e3 / 0.462000e6 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.400e3 0.13e2 / 0.140e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3; -0.13e2 / 0.140e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 -0.121e3 / 0.2800e4 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) - 0.121e3 / 0.42000e5 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) 0 0.2e1 / 0.75e2 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) + 0.74e2 / 0.28875e5 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) - 0.2e1 / 0.75e2 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) + 0.74e2 / 0.28875e5 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) -0.353e3 / 0.462000e6 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.400e3 - 0.353e3 / 0.462000e6 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.400e3 -0.121e3 / 0.42000e5 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) + 0.121e3 / 0.2800e4 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) 0.13e2 / 0.140e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4; -0.16e2 / 0.105e3 0.2e1 / 0.75e2 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) + 0.74e2 / 0.28875e5 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) + 0.2e1 / 0.75e2 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) - 0.74e2 / 0.28875e5 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) -0.2e1 / 0.75e2 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) - 0.74e2 / 0.28875e5 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) + 0.2e1 / 0.75e2 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) - 0.74e2 / 0.28875e5 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) 0 0.2e1 / 0.75e2 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) + 0.74e2 / 0.28875e5 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) - 0.2e1 / 0.75e2 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) + 0.74e2 / 0.28875e5 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) -0.2e1 / 0.75e2 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) - 0.74e2 / 0.28875e5 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) - 0.2e1 / 0.75e2 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) + 0.74e2 / 0.28875e5 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) 0.16e2 / 0.105e3; -0.13e2 / 0.140e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 -0.121e3 / 0.2800e4 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) + 0.121e3 / 0.42000e5 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) 0.353e3 / 0.462000e6 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.400e3 + 0.353e3 / 0.462000e6 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.400e3 -0.2e1 / 0.75e2 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) - 0.74e2 / 0.28875e5 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) + 0.2e1 / 0.75e2 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) - 0.74e2 / 0.28875e5 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) 0 0.121e3 / 0.2800e4 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) + 0.121e3 / 0.42000e5 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) 0.13e2 / 0.140e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4; -0.13e2 / 0.140e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 -sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.400e3 - 0.353e3 / 0.462000e6 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.400e3 + 0.353e3 / 0.462000e6 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) -0.121e3 / 0.2800e4 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) + 0.121e3 / 0.42000e5 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) 0.2e1 / 0.75e2 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) + 0.74e2 / 0.28875e5 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) + 0.2e1 / 0.75e2 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) - 0.74e2 / 0.28875e5 * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) -0.121e3 / 0.2800e4 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) - 0.121e3 / 0.42000e5 * sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) 0 0.13e2 / 0.140e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4; 0.1e1 / 0.42e2 -0.13e2 / 0.140e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 -0.13e2 / 0.140e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 -0.16e2 / 0.105e3 -0.13e2 / 0.140e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 + sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 -0.13e2 / 0.140e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) / 0.105e3 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 - sqrt(0.990e3 - 0.66e2 * sqrt(0.165e3)) * sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.1848e4 - sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) / 0.105e3 + sqrt(0.990e3 + 0.66e2 * sqrt(0.165e3)) * sqrt(0.165e3) / 0.1848e4 0;];

e_l=zeros(m,1);e_l(1)=1;
e_r=zeros(m,1);e_r(m)=1;

D1=HI*(Q-1/2*e_l*e_l'+1/2*e_r*e_r') ;

% Rescale to lim 
L = lim{2} - lim{1};

x = 0.5*x + 0.5; % now between 0 and 1
x = lim{1} + L*x; % now between lim(1) and lim(2)

H = H*L/2;
D1 = D1*2/L;
